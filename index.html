<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developpement Team's Roblox Models</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            transition: background 0.3s;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            color: white;
            padding: 50px 20px 30px;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .floating-buttons {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1000;
        }

        .floating-btn {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            white-space: nowrap;
        }

        .floating-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }

        .floating-btn.suggest-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .floating-btn.collections-btn {
            background: linear-gradient(135deg, #e83e8c, #d63384);
        }

        .floating-btn.history-btn {
            background: linear-gradient(135deg, #fd7e14, #ff8c00);
        }

        .floating-btn.compare-btn {
            background: linear-gradient(135deg, #20c997, #17a2b8);
        }

        .floating-btn.view-suggestions-btn {
            background: linear-gradient(135deg, #ffc107, #ff9800);
        }

        .floating-btn.analytics-btn {
            background: linear-gradient(135deg, #17a2b8, #138496);
        }

        .floating-btn.theme-btn {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }

        .language-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .language-selector select {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-size: 1em;
            cursor: pointer;
            font-weight: 600;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        body.dark-mode .modal-content {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f0f0f0;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            color: #666;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: #ff6b6b;
            color: white;
            transform: rotate(90deg);
        }

        .modal h2 {
            color: #667eea;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.8em;
        }

        body.dark-mode .modal h2 {
            color: #88ccff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        body.dark-mode .form-group label {
            color: #e0e0e0;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            font-family: inherit;
            transition: all 0.3s;
            background: white;
            color: #333;
        }

        body.dark-mode .form-group input,
        body.dark-mode .form-group textarea,
        body.dark-mode .form-group select {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-small {
            width: auto;
            padding: 10px 20px;
            font-size: 0.9em;
            margin: 5px;
        }

        .admin-panel {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
        }

        body.dark-mode .admin-panel {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-panel h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .admin-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .logout-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }

        body.dark-mode .admin-tabs {
            border-bottom-color: #555;
        }

        .admin-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        body.dark-mode .admin-tab {
            color: #aaa;
        }

        .admin-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 12px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
        }

        .file-name {
            margin-top: 8px;
            font-size: 0.9em;
            color: #666;
        }

        body.dark-mode .file-name {
            color: #aaa;
        }

        .preview-image {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            border-radius: 10px;
            display: none;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: white;
            padding: 25px 45px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            text-align: center;
        }

        body.dark-mode .stat-card {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .stat-card h3 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .stat-card p {
            color: #666;
            font-size: 1em;
        }

        body.dark-mode .stat-card p {
            color: #aaa;
        }

        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        body.dark-mode .filter-bar {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .filter-bar label {
            font-weight: 600;
            color: #333;
        }

        body.dark-mode .filter-bar label {
            color: #e0e0e0;
        }

        .filter-bar select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            background: white;
            color: #333;
        }

        body.dark-mode .filter-bar select {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }

        .search-bar {
            background: white;
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        body.dark-mode .search-bar {
            background: #2d2d2d;
        }

        .search-bar input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1em;
            background: white;
            color: #333;
        }

        body.dark-mode .search-bar input {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }

        .search-bar input:focus {
            outline: none;
            border-color: #667eea;
        }

        .models-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .model-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        body.dark-mode .model-card {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .model-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }

        .model-card.hidden {
            opacity: 0.5;
            pointer-events: none;
        }

        .model-card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            position: relative;
        }

        .featured-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 700;
            z-index: 10;
        }

        .model-card-content {
            padding: 20px;
        }

        .model-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        body.dark-mode .model-card h3 {
            color: #88ccff;
        }

        .model-card-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.5;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        body.dark-mode .model-card-description {
            color: #aaa;
        }

        .category-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.75em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .admin-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: 700;
            z-index: 10;
        }

        .download-stat {
            font-size: 0.85em;
            color: #999;
            margin-top: 5px;
        }

        body.dark-mode .download-stat {
            color: #777;
        }

        .model-card-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .download-btn-small,
        .view-btn,
        .favorite-btn,
        .compare-checkbox,
        .share-link-btn {
            flex: 1;
            min-width: 60px;
            padding: 10px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .download-btn-small {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .view-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .favorite-btn {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
        }

        .favorite-btn.favorited {
            background: linear-gradient(135deg, #ffc107, #ff9800);
        }

        .compare-checkbox {
            background: linear-gradient(135deg, #20c997, #17a2b8);
            color: white;
        }

        .share-link-btn {
            background: linear-gradient(135deg, #e83e8c, #d63384);
            color: white;
        }

        .download-btn-small:hover,
        .view-btn:hover,
        .favorite-btn:hover,
        .compare-checkbox:hover,
        .share-link-btn:hover {
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            color: white;
            padding: 60px 20px;
        }

        .empty-state h3 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .message {
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .instructions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        body.dark-mode .instructions {
            background: #3d3d3d;
            border-left-color: #88ccff;
        }

        .instructions h4 {
            color: #333;
            margin-bottom: 10px;
        }

        body.dark-mode .instructions h4 {
            color: #e0e0e0;
        }

        .instructions p {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #555;
        }

        body.dark-mode .instructions p {
            color: #aaa;
        }

        .model-detail-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .detail-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .download-btn-large {
            flex: 1;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 14px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
        }

        .edit-btn,
        .delete-btn,
        .toggle-visibility-btn,
        .feature-btn {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
        }

        .edit-btn {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: white;
        }

        .delete-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }

        .toggle-visibility-btn {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
        }

        .feature-btn {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: white;
        }

        .rating-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        body.dark-mode .rating-section {
            background: #3d3d3d;
        }

        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .star {
            cursor: pointer;
            color: #ddd;
            transition: color 0.2s;
        }

        .star.filled {
            color: #ffc107;
        }

        .star.hover {
            color: #ffc107;
        }

        .review-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        body.dark-mode .review-item {
            background: #3d3d3d;
            border-left-color: #88ccff;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .review-text {
            color: #555;
            font-size: 0.95em;
            line-height: 1.5;
        }

        body.dark-mode .review-text {
            color: #ccc;
        }

        .review-date {
            font-size: 0.8em;
            color: #999;
            margin-top: 8px;
        }

        body.dark-mode .review-date {
            color: #777;
        }

        .collection-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.dark-mode .collection-item {
            background: #3d3d3d;
            border-color: #555;
        }

        .collection-item button {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .history-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.dark-mode .history-item {
            background: #3d3d3d;
            border-left-color: #88ccff;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        body.dark-mode .comparison-card {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .comparison-card h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .comparison-field {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-mode .comparison-field {
            border-bottom-color: #555;
        }

        .comparison-field strong {
            color: #333;
        }

        body.dark-mode .comparison-field strong {
            color: #e0e0e0;
        }

        .gallery-lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .gallery-lightbox.active {
            display: flex;
        }

        .gallery-lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }

        .gallery-lightbox img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 10px;
        }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.3);
            color: white;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 1.5em;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .gallery-nav:hover {
            background: rgba(255,255,255,0.5);
        }

        .gallery-nav.prev {
            left: 10px;
        }

        .gallery-nav.next {
            right: 10px;
        }

        .gallery-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.3);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: background 0.3s;
        }

        .gallery-close:hover {
            background: rgba(255,255,255,0.5);
        }

        .analytics-dashboard {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
        }

        body.dark-mode .analytics-dashboard {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .analytics-dashboard.active {
            display: block;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .analytics-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .analytics-card h4 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .analytics-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }

        .tag-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tag:hover {
            transform: scale(1.05);
        }

        .social-share {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s;
            color: white;
        }

        .share-btn.facebook {
            background: #1877f2;
        }

        .share-btn.twitter {
            background: #1da1f2;
        }

        .share-btn.linkedin {
            background: #0a66c2;
        }

        .share-btn.whatsapp {
            background: #25d366;
        }

        .share-btn.copy-link {
            background: #667eea;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .newsletter-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }

        body.dark-mode .newsletter-section {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .newsletter-section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        body.dark-mode .newsletter-section h3 {
            color: #88ccff;
        }

        .newsletter-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .newsletter-form input {
            flex: 1;
            min-width: 250px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            color: #333;
        }

        body.dark-mode .newsletter-form input {
            background: #3d3d3d;
            color: #e0e0e0;
            border-color: #555;
        }

        .newsletter-form button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .newsletter-form button:hover {
            transform: translateY(-2px);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
        }

        .share-link-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        body.dark-mode .share-link-section {
            background: #3d3d3d;
            border-left-color: #88ccff;
        }

        .share-link-input {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .share-link-input input {
            flex: 1;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9em;
            background: white;
            color: #333;
            font-family: monospace;
        }

        body.dark-mode .share-link-input input {
            background: #2d2d2d;
            color: #e0e0e0;
            border-color: #555;
        }

        .share-link-input button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }
            
            .models-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .floating-buttons {
                bottom: 15px;
                right: 15px;
                gap: 10px;
            }

            .floating-btn {
                padding: 12px 20px;
                font-size: 0.9em;
            }

            .admin-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="language-selector">
        <select id="languageSelect">
            <option value="en">üá∫üá∏ English</option>
            <option value="fr">üá´üá∑ Fran√ßais</option>
        </select>
    </div>

    <div class="container">
        <header>
            <h1 id="headerTitle">üéÆ Developpement Team's Roblox Models</h1>
            <p id="headerSubtitle">Professional Roblox Studio Creations</p>
        </header>

        <div class="stats-bar">
            <div class="stat-card">
                <h3 id="totalModels">0</h3>
                <p id="labelTotalModels">Total Models</p>
            </div>
            <div class="stat-card">
                <h3 id="totalDownloads">0</h3>
                <p id="labelTotalDownloads">Total Downloads</p>
            </div>
            <div class="stat-card">
                <h3 id="totalRatings">0</h3>
                <p id="labelTotalRatings">Total Ratings</p>
            </div>
            <div class="stat-card">
                <h3 id="avgRating">0</h3>
                <p id="labelAvgRating">Average Rating</p>
            </div>
        </div>

        <div class="newsletter-section">
            <h3 id="newsletterTitle">üìß Subscribe to New Releases</h3>
            <p id="newsletterSubtitle">Get notified when new models are released</p>
            <div class="newsletter-form">
                <input type="email" id="newsletterEmail" placeholder="Enter your email...">
                <button id="newsletterSubscribeBtn">Subscribe</button>
            </div>
        </div>

        <div id="analyticsSection" class="analytics-dashboard">
            <h2 id="analyticsTitle">üìä Analytics Dashboard</h2>
            <div class="analytics-grid">
                <div class="analytics-card">
                    <h4 id="labelMostDownloaded">Most Downloaded</h4>
                    <div class="value" id="mostDownloadedStat">-</div>
                </div>
                <div class="analytics-card">
                    <h4 id="labelHighestRated">Highest Rated</h4>
                    <div class="value" id="highestRatedStat">-</div>
                </div>
                <div class="analytics-card">
                    <h4 id="labelTotalFavorites">Total Favorites</h4>
                    <div class="value" id="totalFavoritesStat">0</div>
                </div>
                <div class="analytics-card">
                    <h4 id="labelActiveUsers">Active Users</h4>
                    <div class="value" id="activeUsersStat">0</div>
                </div>
            </div>
            <div style="margin-top: 20px; text-align: right;">
                <button class="btn btn-small" id="exportCSVBtn">üì• Export to CSV</button>
            </div>
        </div>

        <div class="filter-bar">
            <label for="categoryFilter" id="labelCategory">Category:</label>
            <select id="categoryFilter">
                <option value="all">All Categories</option>
                <option value="Building">Building</option>
                <option value="Weapon">Weapon</option>
                <option value="Vehicle">Vehicle</option>
                <option value="Tool">Tool</option>
                <option value="Admin">Admin</option>
                <option value="UI">UI</option>
                <option value="Other">Other</option>
            </select>

            <label for="ratingFilter" id="labelMinRating">Min Rating:</label>
            <select id="ratingFilter">
                <option value="0">All Ratings</option>
                <option value="1">‚≠ê 1+</option>
                <option value="2">‚≠ê‚≠ê 2+</option>
                <option value="3">‚≠ê‚≠ê‚≠ê 3+</option>
                <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4+</option>
                <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5</option>
            </select>

            <label for="sortBy" style="margin-left: auto;" id="labelSortBy">Sort by:</label>
            <select id="sortBy">
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="downloads">Most Downloaded</option>
                <option value="name">Name (A-Z)</option>
                <option value="rating">Highest Rated</option>
            </select>
        </div>

        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="üîç Search models...">
        </div>

        <div id="adminPanel" class="admin-panel">
            <div class="admin-actions">
                <h2 style="flex: 1;" id="adminPanelTitle">‚ú® Admin Panel</h2>
                <button class="logout-btn" id="logoutBtn">üö™ Logout</button>
            </div>
            <div id="adminMessage"></div>

            <div class="admin-tabs">
                <button class="admin-tab active" onclick="switchAdminTab('add-model')">‚ûï Add Model</button>
                <button class="admin-tab" onclick="switchAdminTab('manage-models')">üìã Manage Models</button>
                <button class="admin-tab" onclick="switchAdminTab('notifications')">üîî Notifications</button>
                <button class="admin-tab" onclick="switchAdminTab('stats')">üìà Model Stats</button>
            </div>

            <div id="add-model" class="admin-tab-content active">
                <form id="modelForm">
                    <input type="hidden" id="editingId">
                    
                    <div class="form-group">
                        <label for="modelName" id="labelModelName">üìù Model Name:</label>
                        <input type="text" id="modelName" required placeholder="e.g., Ultimate Admin Panel">
                    </div>

                    <div class="form-group">
                        <label for="modelCategory" id="labelCategoryLabel">üìÇ Category:</label>
                        <select id="modelCategory" required>
                            <option value="">Select a category...</option>
                            <option value="Building">Building</option>
                            <option value="Weapon">Weapon</option>
                            <option value="Vehicle">Vehicle</option>
                            <option value="Tool">Tool</option>
                            <option value="Admin">Admin</option>
                            <option value="UI">UI</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="modelDescription" id="labelDescription">üìÑ Description:</label>
                        <textarea id="modelDescription" required placeholder="Describe your model..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="setupInstructions" id="labelSetupInstructions">üìã Setup Instructions:</label>
                        <textarea id="setupInstructions" required placeholder="1. Open Roblox Studio&#10;2. Insert from file&#10;3. Configure settings"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="modelTags" id="labelModelTags">üè∑Ô∏è Tags (comma-separated):</label>
                        <input type="text" id="modelTags" placeholder="e.g., admin, security, advanced">
                    </div>

                    <div class="form-group">
                        <label id="labelModelImage">üñºÔ∏è Model Image:</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="modelImage" accept="image/*">
                            <label for="modelImage" class="file-input-label" id="btnChooseImage">Choose Image</label>
                        </div>
                        <div class="file-name" id="imageName">No image selected</div>
                        <img id="imagePreview" class="preview-image">
                    </div>

                    <div class="form-group">
                        <label id="labelModelFile">üìÅ Model File (.rbxm or .rbxmx):</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="modelFile" accept=".rbxm,.rbxmx">
                            <label for="modelFile" class="file-input-label" id="btnChooseFile">Choose Model File</label>
                        </div>
                        <div class="file-name" id="fileName">No file selected</div>
                    </div>

                    <button type="submit" class="btn" id="submitBtn">‚úÖ Add Model</button>
                </form>
            </div>

            <div id="manage-models" class="admin-tab-content">
                <button class="btn btn-small" id="bulkDeleteBtn">üóëÔ∏è Delete Selected</button>
                <div id="manageModelsContainer"></div>
            </div>

            <div id="notifications" class="admin-tab-content">
                <h3 id="notificationsTitle">User Feedback & Suggestions</h3>
                <div id="notificationsContainer"></div>
            </div>

            <div id="stats" class="admin-tab-content">
                <h3 id="modelStatsTitle">Per-Model Performance</h3>
                <div id="modelStatsContainer"></div>
            </div>
        </div>

        <div id="modelsContainer" class="models-grid"></div>
    </div>

    <div id="galleryLightbox" class="gallery-lightbox">
        <div class="gallery-lightbox-content">
            <img id="lightboxImage" src="" alt="">
            <button class="gallery-nav prev" id="galleryPrevBtn">‚ùÆ</button>
            <button class="gallery-nav next" id="galleryNextBtn">‚ùØ</button>
            <button class="gallery-close" id="galleryCloseBtn">√ó</button>
        </div>
    </div>

    <div class="floating-buttons">
        <button class="floating-btn collections-btn" id="collectionsBtn">üìö Collections</button>
        <button class="floating-btn history-btn" id="historyBtn">‚è±Ô∏è History</button>
        <button class="floating-btn compare-btn" id="compareBtn">‚öñÔ∏è Compare</button>
        <button class="floating-btn view-suggestions-btn" id="viewSuggestionsBtn">üì¨ Suggestions</button>
        <button class="floating-btn analytics-btn" id="analyticsBtn">üìä Analytics</button>
        <button class="floating-btn suggest-btn" id="suggestBtn">üí° Suggest</button>
        <button class="floating-btn theme-btn" id="themeBtn">üåô Dark Mode</button>
        <button class="floating-btn" id="adminLoginBtn">üîê Admin</button>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeLoginBtn">√ó</button>
            <form id="loginForm">
                <h2 id="adminLoginTitle">üîê Admin Login</h2>
                <div id="loginMessage"></div>
                <div class="form-group">
                    <label for="username" id="labelUsername">Username:</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password" id="labelPassword">Password:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn" id="btnLogin">Login</button>
            </form>
        </div>
    </div>

    <div id="detailModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeDetailBtn">√ó</button>
            <div id="detailContent"></div>
        </div>
    </div>

    <div id="collectionsModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCollectionsBtn">√ó</button>
            <h2 id="collectionsTitle">üìö My Collections</h2>
            <div class="form-group">
                <input type="text" id="newCollectionName" placeholder="Create new collection...">
                <button class="btn btn-small" id="createCollectionBtn">Create</button>
            </div>
            <div id="collectionsContainer"></div>
        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeHistoryBtn">√ó</button>
            <h2 id="historyTitle">‚è±Ô∏è Download History</h2>
            <div id="historyContainer"></div>
        </div>
    </div>

    <div id="compareModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeCompareBtn">√ó</button>
            <h2 id="compareTitle">‚öñÔ∏è Compare Models</h2>
            <div id="compareContainer"></div>
        </div>
    </div>

    <div id="suggestionModal" class="modal">
        <div class="modal-content">
            <button class="close-btn" id="closeSuggestionBtn">√ó</button>
            <form id="suggestionForm">
                <h2 id="suggestTitle">üí° Submit Suggestion</h2>
                <p style="color: #666; text-align: center; margin-bottom: 20px;" id="suggestSubtitle">Share your ideas with us!</p>
                <div id="suggestionMessage"></div>
                <div class="form-group">
                    <label for="suggestionName" id="labelYourName">Your Name:</label>
                    <input type="text" id="suggestionName" required>
                </div>
                <div class="form-group">
                    <label for="suggestionEmail" id="labelEmailOptional">Email (optional):</label>
                    <input type="email" id="suggestionEmail">
                </div>
                <div class="form-group">
                    <label for="suggestionText" id="labelYourSuggestion">Your Suggestion:</label>
                    <textarea id="suggestionText" required placeholder="Tell us your ideas..."></textarea>
                </div>
                <button type="submit" class="btn" id="btnSubmit">üì§ Submit</button>
            </form>
        </div>
    </div>

    <script>
        const ADMIN_USERNAME = 'DeveloppementTeam';
        const ADMIN_PASSWORD = 'Roblox@Dev2024#Secure!';
        
        let isAdmin = false;
        let currentLang = 'en';
        let models = JSON.parse(localStorage.getItem('roblox-models-global')) || [];
        let favorites = JSON.parse(localStorage.getItem('roblox-favorites')) || [];
        let ratings = JSON.parse(localStorage.getItem('roblox-ratings')) || {};
        let subscribers = JSON.parse(localStorage.getItem('roblox-subscribers')) || [];
        let collections = JSON.parse(localStorage.getItem('roblox-collections')) || {};
        let downloadHistory = JSON.parse(localStorage.getItem('roblox-history')) || [];
        let compareList = [];
        let selectedModels = [];
        let featuredModels = JSON.parse(localStorage.getItem('roblox-featured')) || [];
        let hiddenModels = JSON.parse(localStorage.getItem('roblox-hidden')) || [];

        const translations = {
            en: {
                title: "Developpement Team's Roblox Models",
                subtitle: "Professional Roblox Studio Creations",
                totalModels: "Total Models",
                totalDownloads: "Total Downloads",
                totalRatings: "Total Ratings",
                avgRating: "Average Rating",
                category: "Category:",
                minRating: "Min Rating:",
                sortBy: "Sort by:",
                newest: "Newest First",
                oldest: "Oldest First",
                mostDownloaded: "Most Downloaded",
                nameAZ: "Name (A-Z)",
                highestRated: "Highest Rated",
                searchPlaceholder: "üîç Search models...",
                adminPanel: "‚ú® Admin Panel",
                logout: "üö™ Logout",
                modelName: "üìù Model Name:",
                categoryLabel: "üìÇ Category:",
                description: "üìÑ Description:",
                setupInstructions: "üìã Setup Instructions:",
                modelTags: "üè∑Ô∏è Tags:",
                modelImage: "üñºÔ∏è Model Image:",
                chooseImage: "Choose Image",
                noImage: "No image selected",
                modelFile: "üìÅ Model File (.rbxm or .rbxmx):",
                chooseFile: "Choose Model File",
                noFile: "No file selected",
                addModel: "‚úÖ Add Model",
                updateModel: "‚úÖ Update Model",
                download: "‚¨áÔ∏è Download",
                view: "üëÅÔ∏è View",
                downloads: "downloads",
                adminLogin: "üîê Admin",
                suggest: "üí° Suggest",
                viewSuggestions: "üì¨ Suggestions",
                adminLoginTitle: "üîê Admin Login",
                username: "Username:",
                password: "Password:",
                login: "Login",
                suggestTitle: "üí° Submit Suggestion",
                suggestSubtitle: "Share your ideas with us!",
                yourName: "Your Name:",
                emailOptional: "Email (optional):",
                yourSuggestion: "Your Suggestion:",
                submit: "üì§ Submit",
                noModelsFound: "No models found!",
                tryDifferentSearch: "Try adjusting your filters",
                invalidCredentials: "‚ùå Invalid credentials!",
                welcome: "‚úÖ Welcome!",
                thankYou: "‚úÖ Thank you!",
                updated: "‚úÖ Updated!",
                added: "‚úÖ Model Added Successfully!",
                deleted: "‚úÖ Deleted!",
                selectModelFile: "‚ö†Ô∏è Please select a model file!",
                deleteConfirm: "üóëÔ∏è Delete this model?",
                logoutConfirm: "Logout?",
                noSuggestions: "No suggestions yet!",
                userSuggestions: "üí° User Suggestions",
                edit: "‚úèÔ∏è Edit",
                delete: "üóëÔ∏è Delete",
                Building: "Building",
                Weapon: "Weapon",
                Vehicle: "Vehicle",
                Tool: "Tool",
                Admin: "Admin",
                UI: "UI",
                Other: "Other",
                rateModel: "Rate this model",
                yourRating: "Your Rating:",
                share: "Share",
                exportCSV: "üì• Export to CSV",
                darkMode: "üåô Dark Mode",
                lightMode: "‚òÄÔ∏è Light Mode",
                newsletter: "üìß Subscribe to New Releases",
                newsletterSubtitle: "Get notified when new models are released",
                subscribe: "Subscribe",
                subscribed: "‚úÖ Subscribed!",
                analytics: "üìä Analytics",
                mostDownloadedModel: "Most Downloaded",
                highestRatedModel: "Highest Rated",
                totalFavorites: "Total Favorites",
                activeUsers: "Active Users",
                tags: "Tags",
                collections: "üìö Collections",
                history: "‚è±Ô∏è History",
                compare: "‚öñÔ∏è Compare",
                addToCollection: "Add to Collection",
                createCollection: "Create Collection",
                myCollections: "üìö My Collections",
                downloadHistory: "‚è±Ô∏è Download History",
                compareModels: "‚öñÔ∏è Compare Models",
                selectModelsToCompare: "Select up to 3 models to compare",
                feature: "‚≠ê Feature",
                unfeature: "‚òÜ Unfeature",
                hide: "üëÅÔ∏è Hide",
                show: "üëÄ Show",
                bulkDelete: "üóëÔ∏è Delete Selected",
                manageModels: "üìã Manage Models",
                notifications: "üîî Notifications",
                modelStats: "üìà Model Stats",
                addReview: "Add Review",
                leaveReview: "Leave a Review",
                yourReview: "Your Review:",
                reviews: "Reviews",
                noReviews: "No reviews yet",
                timestamp: "Timestamp",
                shareLink: "üîó Share Link",
                copyLink: "Copy Link",
                linkCopied: "Link copied to clipboard!"
            },
            fr: {
                title: "Mod√®les Roblox de Developpement Team",
                subtitle: "Cr√©ations Professionnelles Roblox Studio",
                totalModels: "Total Mod√®les",
                totalDownloads: "Total T√©l√©chargements",
                totalRatings: "Total √âvaluations",
                avgRating: "√âvaluation Moyenne",
                category: "Cat√©gorie:",
                minRating: "√âvaluation Min:",
                sortBy: "Trier par:",
                newest: "Plus R√©cent",
                oldest: "Plus Ancien",
                mostDownloaded: "Plus T√©l√©charg√©",
                nameAZ: "Nom (A-Z)",
                highestRated: "Mieux Not√©",
                searchPlaceholder: "üîç Rechercher des mod√®les...",
                adminPanel: "‚ú® Panneau Admin",
                logout: "üö™ D√©connexion",
                modelName: "üìù Nom du Mod√®le:",
                categoryLabel: "üìÇ Cat√©gorie:",
                description: "üìÑ Description:",
                setupInstructions: "üìã Instructions d'Installation:",
                modelTags: "üè∑Ô∏è Tags:",
                modelImage: "üñºÔ∏è Image du Mod√®le:",
                chooseImage: "Choisir Image",
                noImage: "Aucune image",
                modelFile: "üìÅ Fichier Mod√®le (.rbxm ou .rbxmx):",
                chooseFile: "Choisir Fichier",
                noFile: "Aucun fichier",
                addModel: "‚úÖ Ajouter Mod√®le",
                updateModel: "‚úÖ Mettre √† Jour",
                download: "‚¨áÔ∏è T√©l√©charger",
                view: "üëÅÔ∏è Voir",
                downloads: "t√©l√©chargements",
                adminLogin: "üîê Admin",
                suggest: "üí° Sugg√©rer",
                viewSuggestions: "üì¨ Suggestions",
                adminLoginTitle: "üîê Connexion Admin",
                username: "Nom d'utilisateur:",
                password: "Mot de passe:",
                login: "Connexion",
                suggestTitle: "üí° Soumettre Suggestion",
                suggestSubtitle: "Partagez vos id√©es!",
                yourName: "Votre Nom:",
                emailOptional: "Email (optionnel):",
                yourSuggestion: "Votre Suggestion:",
                submit: "üì§ Envoyer",
                noModelsFound: "Aucun mod√®le trouv√©!",
                tryDifferentSearch: "Ajustez vos filtres",
                invalidCredentials: "‚ùå Identifiants invalides!",
                welcome: "‚úÖ Bienvenue!",
                thankYou: "‚úÖ Merci!",
                updated: "‚úÖ Mis √† jour!",
                added: "‚úÖ Mod√®le Ajout√© avec Succ√®s!",
                deleted: "‚úÖ Supprim√©!",
                selectModelFile: "‚ö†Ô∏è S√©lectionnez un fichier!",
                deleteConfirm: "üóëÔ∏è Supprimer ce mod√®le?",
                logoutConfirm: "Se d√©connecter?",
                noSuggestions: "Aucune suggestion!",
                userSuggestions: "üí° Suggestions des Utilisateurs",
                edit: "‚úèÔ∏è Modifier",
                delete: "üóëÔ∏è Supprimer",
                Building: "Construction",
                Weapon: "Arme",
                Vehicle: "V√©hicule",
                Tool: "Outil",
                Admin: "Admin",
                UI: "Interface",
                Other: "Autre",
                rateModel: "√âvaluer ce mod√®le",
                yourRating: "Votre √âvaluation:",
                share: "Partager",
                exportCSV: "üì• Exporter en CSV",
                darkMode: "üåô Mode Sombre",
                lightMode: "‚òÄÔ∏è Mode Clair",
                newsletter: "üìß S'abonner aux Nouvelles Versions",
                newsletterSubtitle: "Soyez notifi√© quand de nouveaux mod√®les sont publi√©s",
                subscribe: "S'abonner",
                subscribed: "‚úÖ Abonn√©!",
                analytics: "üìä Analytique",
                mostDownloadedModel: "Plus T√©l√©charg√©",
                highestRatedModel: "Mieux Not√©",
                totalFavorites: "Total Favoris",
                activeUsers: "Utilisateurs Actifs",
                tags: "Tags",
                collections: "üìö Collections",
                history: "‚è±Ô∏è Historique",
                compare: "‚öñÔ∏è Comparer",
                addToCollection: "Ajouter √† la Collection",
                createCollection: "Cr√©er une Collection",
                myCollections: "üìö Mes Collections",
                downloadHistory: "‚è±Ô∏è Historique T√©l√©chargements",
                compareModels: "‚öñÔ∏è Comparer Mod√®les",
                selectModelsToCompare: "S√©lectionnez jusqu'√† 3 mod√®les √† comparer",
                feature: "‚≠ê Mettre en Avant",
                unfeature: "‚òÜ Retirer",
                hide: "üëÅÔ∏è Masquer",
                show: "üëÄ Afficher",
                bulkDelete: "üóëÔ∏è Supprimer S√©lection",
                manageModels: "üìã G√©rer Mod√®les",
                notifications: "üîî Notifications",
                modelStats: "üìà Statistiques Mod√®les",
                addReview: "Ajouter Avis",
                leaveReview: "Laisser un Avis",
                yourReview: "Votre Avis:",
                reviews: "Avis",
                noReviews: "Aucun avis",
                timestamp: "Date/Heure",
                shareLink: "üîó Lien de Partage",
                copyLink: "Copier Lien",
                linkCopied: "Lien copi√©!"
            }
        };

        function loadData() {
            renderModels();
            updateStats();
        }

        function saveData() {
            localStorage.setItem('roblox-models-global', JSON.stringify(models));
        }

        function generateModelLink(modelId) {
            const baseUrl = window.location.href.split('?')[0].split('#')[0];
            return baseUrl + '?model=' + modelId;
        }

        function loadModelFromURL() {
            const params = new URLSearchParams(window.location.search);
            const modelId = params.get('model');
            if (modelId) {
                const model = models.find(m => m.id == modelId);
                if (model) {
                    setTimeout(() => viewModel(parseInt(modelId)), 500);
                }
            }
        }

        function updateStats() {
            const totalDownloads = models.reduce((sum, m) => sum + (m.downloads || 0), 0);
            const allRatings = Object.values(ratings).flat();
            const avgRating = allRatings.length > 0 ? (allRatings.reduce((a, b) => a + b, 0) / allRatings.length).toFixed(1) : 0;
            
            document.getElementById('totalModels').textContent = models.length;
            document.getElementById('totalDownloads').textContent = totalDownloads;
            document.getElementById('totalRatings').textContent = allRatings.length;
            document.getElementById('avgRating').textContent = avgRating;
            
            document.getElementById('totalFavoritesStat').textContent = favorites.length;
            document.getElementById('activeUsersStat').textContent = new Set([...subscribers, ...Object.keys(ratings)]).size;
            
            if (models.length > 0) {
                const mostDownloaded = [...models].sort((a, b) => (b.downloads || 0) - (a.downloads || 0))[0];
                document.getElementById('mostDownloadedStat').textContent = mostDownloaded.name;
                
                const highestRated = [...models].sort((a, b) => {
                    const rA = ratings[a.id] ? ratings[a.id].reduce((x, y) => x + y, 0) / ratings[a.id].length : 0;
                    const rB = ratings[b.id] ? ratings[b.id].reduce((x, y) => x + y, 0) / ratings[b.id].length : 0;
                    return rB - rA;
                })[0];
                document.getElementById('highestRatedStat').textContent = highestRated.name;
            }
        }

        function renderModels() {
            const t = translations[currentLang];
            const container = document.getElementById('modelsContainer');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const ratingFilter = parseInt(document.getElementById('ratingFilter').value);
            const sortBy = document.getElementById('sortBy').value;

            let filtered = models.filter(m => {
                if (hiddenModels.includes(m.id)) return false;
                const matchesSearch = m.name.toLowerCase().includes(searchTerm) || 
                                     m.description.toLowerCase().includes(searchTerm) ||
                                     (m.tags && m.tags.some(tag => tag.toLowerCase().includes(searchTerm)));
                const matchesCategory = categoryFilter === 'all' || m.category === categoryFilter;
                const modelRating = ratings[m.id] ? ratings[m.id].reduce((a, b) => a + b, 0) / ratings[m.id].length : 0;
                const matchesRating = modelRating >= ratingFilter;
                
                return matchesSearch && matchesCategory && matchesRating;
            });

            const featured = filtered.filter(m => featuredModels.includes(m.id));
            const notFeatured = filtered.filter(m => !featuredModels.includes(m.id));

            if (sortBy === 'newest') notFeatured.sort((a, b) => b.id - a.id);
            else if (sortBy === 'oldest') notFeatured.sort((a, b) => a.id - b.id);
            else if (sortBy === 'downloads') notFeatured.sort((a, b) => (b.downloads || 0) - (a.downloads || 0));
            else if (sortBy === 'name') notFeatured.sort((a, b) => a.name.localeCompare(b.name));
            else if (sortBy === 'rating') {
                notFeatured.sort((a, b) => {
                    const ratingA = ratings[a.id] ? ratings[a.id].reduce((x, y) => x + y, 0) / ratings[a.id].length : 0;
                    const ratingB = ratings[b.id] ? ratings[b.id].reduce((x, y) => x + y, 0) / ratings[b.id].length : 0;
                    return ratingB - ratingA;
                });
            }

            const allFiltered = [...featured, ...notFeatured];

            if (allFiltered.length === 0) {
                container.innerHTML = `<div class="empty-state"><h3>${t.noModelsFound}</h3><p>${t.tryDifferentSearch}</p></div>`;
                return;
            }

            container.innerHTML = allFiltered.map(model => {
                const modelRatingValue = ratings[model.id] ? (ratings[model.id].reduce((a, b) => a + b, 0) / ratings[model.id].length).toFixed(1) : 'N/A';
                const isFavorited = favorites.includes(model.id);
                const stars = '‚≠ê'.repeat(Math.round(modelRatingValue === 'N/A' ? 0 : modelRatingValue));
                const isFeatured = featuredModels.includes(model.id);
                
                return `
                    <div class="model-card">
                        ${isFeatured ? '<div class="featured-badge">‚≠ê FEATURED</div>' : ''}
                        ${isAdmin ? '<div class="admin-badge">Admin</div>' : ''}
                        <img src="${model.imageData || 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22280%22 height=%22200%22%3E%3Crect fill=%22%23667eea%22 width=%22280%22 height=%22200%22/%3E%3C/svg%3E'}" class="model-card-image" alt="${model.name}">
                        <div class="model-card-content">
                            <span class="category-badge">${t[model.category]}</span>
                            <h3>${model.name}</h3>
                            <p class="model-card-description">${model.description}</p>
                            ${model.tags ? `<div class="tag-container">${model.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}</div>` : ''}
                            <div class="download-stat">${stars} ${modelRatingValue} | ${model.downloads || 0} ${t.downloads}</div>
                            <div class="model-card-actions">
                                <button class="download-btn-small" onclick="downloadModel(${model.id})">${t.download}</button>
                                <button class="view-btn" onclick="viewModel(${model.id})">${t.view}</button>
                                <button class="favorite-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite(${model.id})">${isFavorited ? '‚ù§Ô∏è' : 'ü§ç'}</button>
                                <button class="compare-checkbox" onclick="toggleCompare(${model.id})">‚öñÔ∏è</button>
                                <button class="share-link-btn" onclick="copyShareLink(${model.id})">üîó</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function copyShareLink(id) {
            const link = generateModelLink(id);
            navigator.clipboard.writeText(link).then(() => {
                alert(translations[currentLang].linkCopied);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('Failed to copy link');
            });
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');

            if (tab === 'manage-models') renderManageModels();
            if (tab === 'notifications') renderNotifications();
            if (tab === 'stats') renderModelStats();
        }

        function renderManageModels() {
            const t = translations[currentLang];
            const container = document.getElementById('manageModelsContainer');
            container.innerHTML = models.map(m => `
                <div style="background: white; padding: 15px; border-radius: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                    <div>
                        <strong>${m.name}</strong><br>
                        <small>${t[m.category]}</small>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <input type="checkbox" onchange="toggleModelSelection(${m.id})" style="width: 20px; height: 20px; cursor: pointer;">
                        <button class="btn btn-small" onclick="editModel(${m.id})">${t.edit}</button>
                        <button class="btn btn-small" style="background: linear-gradient(135deg, #ffc107, #ff9800);" onclick="toggleFeature(${m.id})">${featuredModels.includes(m.id) ? t.unfeature : t.feature}</button>
                        <button class="btn btn-small" style="background: linear-gradient(135deg, #17a2b8, #138496);" onclick="toggleHide(${m.id})">${hiddenModels.includes(m.id) ? t.show : t.hide}</button>
                        <button class="btn btn-small" style="background: linear-gradient(135deg, #e83e8c, #d63384);" onclick="copyShareLink(${m.id})">${t.shareLink}</button>
                    </div>
                </div>
            `).join('');
        }

        function renderNotifications() {
            const t = translations[currentLang];
            const container = document.getElementById('notificationsContainer');
            let suggestions = JSON.parse(localStorage.getItem('roblox-suggestions')) || [];
            if (suggestions.length === 0) {
                container.innerHTML = `<p>${t.noSuggestions}</p>`;
                return;
            }
            container.innerHTML = suggestions.reverse().map(s => `
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 10px 0; border-left: 4px solid #667eea;">
                    <strong>${s.name}</strong> ${s.email ? `(${s.email})` : ''}<br>
                    <p style="margin-top: 10px;">${s.message}</p>
                    <small style="color: #999;">${new Date(s.date).toLocaleDateString()}</small>
                </div>
            `).join('');
        }

        function renderModelStats() {
            const t = translations[currentLang];
            const container = document.getElementById('modelStatsContainer');
            container.innerHTML = models.map(m => {
                const rating = ratings[m.id] ? (ratings[m.id].reduce((a, b) => a + b, 0) / ratings[m.id].length).toFixed(1) : 'N/A';
                return `
                    <div style="background: white; padding: 15px; border-radius: 10px; margin: 10px 0;">
                        <strong>${m.name}</strong><br>
                        <small>üì• Downloads: ${m.downloads || 0} | ‚≠ê Rating: ${rating} | üí¨ Reviews: ${ratings[m.id] ? ratings[m.id].length : 0}</small>
                    </div>
                `;
            }).join('');
        }

        function toggleModelSelection(id) {
            const idx = selectedModels.indexOf(id);
            if (idx > -1) selectedModels.splice(idx, 1);
            else selectedModels.push(id);
        }

        function toggleCompare(id) {
            const idx = compareList.indexOf(id);
            if (idx > -1) {
                compareList.splice(idx, 1);
            } else if (compareList.length < 3) {
                compareList.push(id);
            } else {
                alert('You can only compare up to 3 models');
            }
        }

        function toggleFeature(id) {
            const idx = featuredModels.indexOf(id);
            if (idx > -1) featuredModels.splice(idx, 1);
            else featuredModels.push(id);
            localStorage.setItem('roblox-featured', JSON.stringify(featuredModels));
            renderModels();
        }

        function toggleHide(id) {
            const idx = hiddenModels.indexOf(id);
            if (idx > -1) hiddenModels.splice(idx, 1);
            else hiddenModels.push(id);
            localStorage.setItem('roblox-hidden', JSON.stringify(hiddenModels));
            renderModels();
        }

        function viewModel(id) {
            const t = translations[currentLang];
            const model = models.find(m => m.id === id);
            if (!model) return;

            const modelRatingValue = ratings[model.id] ? (ratings[model.id].reduce((a, b) => a + b, 0) / ratings[model.id].length).toFixed(1) : 'N/A';
            const userRatings = ratings[model.id] || [];
            const reviews = JSON.parse(localStorage.getItem(`roblox-reviews-${id}`)) || [];
            const shareLink = generateModelLink(id);
            
            let html = `
                <h2>${model.name}</h2>
                ${model.imageData ? `<img src="${model.imageData}" class="model-detail-image">` : ''}
                <p><strong>${t.category}:</strong> ${t[model.category]}</p>
                <p><strong>${t.description}:</strong> ${model.description}</p>
                
                <div class="share-link-section">
                    <h4>${t.shareLink}</h4>
                    <div class="share-link-input">
                        <input type="text" value="${shareLink}" readonly>
                        <button onclick="copyToClipboard('${shareLink}')">${t.copyLink}</button>
                    </div>
                </div>
                
                <div class="rating-section">
                    <h4>${t.rateModel}</h4>
                    <div class="star-rating" id="ratingStars">
                        ${[1,2,3,4,5].map(i => `<span class="star" onclick="rateModel(${model.id}, ${i})" onmouseover="hoverStar(${i})" onmouseout="resetStars(${modelRatingValue === 'N/A' ? 0 : Math.round(modelRatingValue)})">‚òÖ</span>`).join('')}
                    </div>
                    <p>${t.yourRating}: <strong>${modelRatingValue}</strong> (${userRatings.length} ${t.totalRatings})</p>
                </div>

                <div class="rating-section">
                    <h4>${t.leaveReview}</h4>
                    <textarea id="reviewText" placeholder="${t.yourReview}" style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid #e0e0e0; margin-bottom: 10px;"></textarea>
                    <button class="btn btn-small" onclick="submitReview(${model.id})">${t.addReview}</button>
                </div>

                <div class="rating-section">
                    <h4>${t.reviews}</h4>
                    ${reviews.length === 0 ? `<p>${t.noReviews}</p>` : reviews.map(r => `
                        <div class="review-item">
                            <div class="review-header">
                                <strong>${r.name}</strong>
                                <span class="review-date">${new Date(r.date).toLocaleDateString()}</span>
                            </div>
                            <div class="review-text">${r.text}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="social-share">
                    <button class="share-btn facebook" onclick="shareModel(${model.id}, 'facebook')">f Facebook</button>
                    <button class="share-btn twitter" onclick="shareModel(${model.id}, 'twitter')">ùïè Twitter</button>
                    <button class="share-btn linkedin" onclick="shareModel(${model.id}, 'linkedin')">in LinkedIn</button>
                    <button class="share-btn whatsapp" onclick="shareModel(${model.id}, 'whatsapp')">üí¨ WhatsApp</button>
                    <button class="share-btn copy-link" onclick="copyShareLink(${model.id})">üîó ${t.copyLink}</button>
                </div>

                <div class="instructions">
                    <h4>${t.setupInstructions}</h4>
                    <p>${model.instructions}</p>
                </div>
                
                <div class="detail-actions">
                    <button class="download-btn-large" onclick="downloadModel(${model.id})">${t.download}</button>
                    ${isAdmin ? `<button class="edit-btn" onclick="editModel(${model.id})">${t.edit}</button>` : ''}
                    ${isAdmin ? `<button class="delete-btn" onclick="deleteModel(${model.id})">${t.delete}</button>` : ''}
                </div>
            `;
            
            document.getElementById('detailContent').innerHTML = html;
            document.getElementById('detailModal').classList.add('active');
            resetStars(modelRatingValue === 'N/A' ? 0 : Math.round(modelRatingValue));
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert(translations[currentLang].linkCopied);
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        function submitReview(id) {
            const text = document.getElementById('reviewText').value;
            if (!text.trim()) return;
            
            let reviews = JSON.parse(localStorage.getItem(`roblox-reviews-${id}`)) || [];
            reviews.push({
                name: 'Anonymous User',
                text: text,
                date: new Date().toISOString()
            });
            localStorage.setItem(`roblox-reviews-${id}`, JSON.stringify(reviews));
            document.getElementById('reviewText').value = '';
            viewModel(id);
        }

        function hoverStar(rating) {
            const stars = document.querySelectorAll('#ratingStars .star');
            stars.forEach((s, i) => {
                s.classList.toggle('hover', i < rating);
            });
        }

        function resetStars(rating) {
            const stars = document.querySelectorAll('#ratingStars .star');
            stars.forEach((s, i) => {
                s.classList.remove('hover');
                s.classList.toggle('filled', i < rating);
            });
        }

        function rateModel(id, rating) {
            if (!ratings[id]) ratings[id] = [];
            ratings[id].push(rating);
            localStorage.setItem('roblox-ratings', JSON.stringify(ratings));
            updateStats();
            viewModel(id);
            renderModels();
        }

        function toggleFavorite(id) {
            const index = favorites.indexOf(id);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(id);
            }
            localStorage.setItem('roblox-favorites', JSON.stringify(favorites));
            updateStats();
            renderModels();
        }

        function shareModel(id, platform) {
            const model = models.find(m => m.id === id);
            const text = `Check out this amazing Roblox model: ${model.name}`;
            const url = generateModelLink(id);
            
            const shareUrls = {
                facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
                twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
                linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`,
                whatsapp: `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`
            };
            
            window.open(shareUrls[platform], '_blank');
        }

        function downloadModel(id) {
            const model = models.find(m => m.id === id);
            if (!model) return;
            
            if (model.fileData) {
                const link = document.createElement('a');
                link.href = model.fileData;
                link.download = model.fileName || 'model.rbxm';
                link.click();
            }
            
            model.downloads = (model.downloads || 0) + 1;
            downloadHistory.push({
                modelId: id,
                modelName: model.name,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('roblox-history', JSON.stringify(downloadHistory));
            saveData();
            updateStats();
            renderModels();
        }

        function editModel(id) {
            const model = models.find(m => m.id === id);
            if (!model) return;
            
            document.getElementById('editingId').value = id;
            document.getElementById('modelName').value = model.name;
            document.getElementById('modelCategory').value = model.category;
            document.getElementById('modelDescription').value = model.description;
            document.getElementById('setupInstructions').value = model.instructions;
            document.getElementById('modelTags').value = model.tags ? model.tags.join(', ') : '';
            document.getElementById('submitBtn').textContent = translations[currentLang].updateModel;
            
            document.getElementById('detailModal').classList.remove('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function deleteModel(id) {
            if (confirm(translations[currentLang].deleteConfirm)) {
                models = models.filter(m => m.id !== id);
                saveData();
                renderModels();
                updateStats();
                document.getElementById('detailModal').classList.remove('active');
            }
        }

        function resetForm() {
            document.getElementById('modelForm').reset();
            document.getElementById('editingId').value = '';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('imageName').textContent = translations[currentLang].noImage;
            document.getElementById('fileName').textContent = translations[currentLang].noFile;
            document.getElementById('submitBtn').textContent = translations[currentLang].addModel;
        }

        function subscribeNewsletter() {
            const email = document.getElementById('newsletterEmail').value;
            if (!email || !email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }
            
            if (!subscribers.includes(email)) {
                subscribers.push(email);
                localStorage.setItem('roblox-subscribers', JSON.stringify(subscribers));
            }
            
            alert(translations[currentLang].subscribed);
            document.getElementById('newsletterEmail').value = '';
            updateStats();
        }

        function exportToCSV() {
            const headers = ['Name', 'Category', 'Description', 'Downloads', 'Rating', 'Tags'];
            const rows = models.map(m => {
                const rating = ratings[m.id] ? (ratings[m.id].reduce((a, b) => a + b, 0) / ratings[m.id].length).toFixed(1) : 'N/A';
                return [m.name, m.category, m.description, m.downloads || 0, rating, m.tags ? m.tags.join(';') : ''];
            });
            
            let csv = headers.join(',') + '\n';
            rows.forEach(row => {
                csv += row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'roblox-models-data.csv';
            link.click();
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('roblox-theme', isDark ? 'dark' : 'light');
            document.getElementById('themeBtn').textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
        }

        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('headerTitle').textContent = t.title;
            document.getElementById('headerSubtitle').textContent = t.subtitle;
            document.getElementById('labelTotalModels').textContent = t.totalModels;
            document.getElementById('labelTotalDownloads').textContent = t.totalDownloads;
            document.getElementById('labelTotalRatings').textContent = t.totalRatings;
            document.getElementById('labelAvgRating').textContent = t.avgRating;
            document.getElementById('newsletterTitle').textContent = t.newsletter;
            document.getElementById('newsletterSubtitle').textContent = t.newsletterSubtitle;
            document.getElementById('newsletterSubscribeBtn').textContent = t.subscribe;
            document.getElementById('analyticsTitle').textContent = t.analytics;
            document.getElementById('labelMostDownloaded').textContent = t.mostDownloadedModel;
            document.getElementById('labelHighestRated').textContent = t.highestRatedModel;
            document.getElementById('labelTotalFavorites').textContent = t.totalFavorites;
            document.getElementById('labelActiveUsers').textContent = t.activeUsers;
            document.getElementById('exportCSVBtn').textContent = t.exportCSV;
            document.getElementById('labelCategory').textContent = t.category;
            document.getElementById('labelMinRating').textContent = t.minRating;
            document.getElementById('labelSortBy').textContent = t.sortBy;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            document.getElementById('viewSuggestionsBtn').textContent = t.viewSuggestions;
            document.getElementById('suggestBtn').textContent = t.suggest;
            document.getElementById('adminLoginBtn').textContent = t.adminLogin;
            document.getElementById('themeBtn').textContent = document.body.classList.contains('dark-mode') ? t.lightMode : t.darkMode;
            document.getElementById('collectionsBtn').textContent = t.collections;
            document.getElementById('historyBtn').textContent = t.history;
            document.getElementById('compareBtn').textContent = t.compare;
        }

        document.getElementById('adminLoginBtn').addEventListener('click', () => document.getElementById('loginModal').classList.add('active'));
        document.getElementById('closeLoginBtn').addEventListener('click', () => document.getElementById('loginModal').classList.remove('active'));
        document.getElementById('suggestBtn').addEventListener('click', () => document.getElementById('suggestionModal').classList.add('active'));
        document.getElementById('closeSuggestionBtn').addEventListener('click', () => document.getElementById('suggestionModal').classList.remove('active'));
        document.getElementById('closeDetailBtn').addEventListener('click', () => document.getElementById('detailModal').classList.remove('active'));
        document.getElementById('collectionsBtn').addEventListener('click', () => {
            const t = translations[currentLang];
            const container = document.getElementById('collectionsContainer');
            const collectionNames = Object.keys(collections);
            container.innerHTML = collectionNames.length === 0 ? '<p>No collections yet</p>' : collectionNames.map(name => `
                <div class="collection-item">
                    <strong>${name}</strong>
                    <button class="btn btn-small" style="background: #dc3545;" onclick="deleteCollection('${name}')">Delete</button>
                </div>
            `).join('');
            document.getElementById('collectionsModal').classList.add('active');
        });
        document.getElementById('closeCollectionsBtn').addEventListener('click', () => document.getElementById('collectionsModal').classList.remove('active'));
        document.getElementById('createCollectionBtn').addEventListener('click', function() {
            const name = document.getElementById('newCollectionName').value.trim();
            if (name && !collections[name]) {
                collections[name] = [];
                localStorage.setItem('roblox-collections', JSON.stringify(collections));
                document.getElementById('newCollectionName').value = '';
                document.getElementById('collectionsBtn').click();
            }
        });
        document.getElementById('historyBtn').addEventListener('click', () => {
            const t = translations[currentLang];
            const container = document.getElementById('historyContainer');
            container.innerHTML = downloadHistory.length === 0 ? '<p>No downloads yet</p>' : downloadHistory.reverse().map(h => `
                <div class="history-item">
                    <div>
                        <strong>${h.modelName}</strong><br>
                        <small>${new Date(h.timestamp).toLocaleString()}</small>
                    </div>
                </div>
            `).join('');
            document.getElementById('historyModal').classList.add('active');
        });
        document.getElementById('closeHistoryBtn').addEventListener('click', () => document.getElementById('historyModal').classList.remove('active'));
        document.getElementById('compareBtn').addEventListener('click', () => {
            const t = translations[currentLang];
            const container = document.getElementById('compareContainer');
            if (compareList.length === 0) {
                container.innerHTML = `<p>${t.selectModelsToCompare}</p>`;
            } else {
                const comparingModels = models.filter(m => compareList.includes(m.id));
                container.innerHTML = `<div class="comparison-grid">${comparingModels.map(m => {
                    const rating = ratings[m.id] ? (ratings[m.id].reduce((a, b) => a + b, 0) / ratings[m.id].length).toFixed(1) : 'N/A';
                    return `
                        <div class="comparison-card">
                            <h3>${m.name}</h3>
                            <div class="comparison-field"><strong>${t.category}:</strong> ${t[m.category]}</div>
                            <div class="comparison-field"><strong>${t.download}:</strong> ${m.downloads || 0}</div>
                            <div class="comparison-field"><strong>${t.yourRating}:</strong> ${rating}</div>
                            <div class="comparison-field"><strong>${t.description}:</strong> ${m.description}</div>
                        </div>
                    `;
                }).join('')}</div>`;
            }
            document.getElementById('compareModal').classList.add('active');
        });
        document.getElementById('closeCompareBtn').addEventListener('click', () => document.getElementById('compareModal').classList.remove('active'));
        document.getElementById('themeBtn').addEventListener('click', toggleTheme);
        document.getElementById('analyticsBtn').addEventListener('click', () => document.getElementById('analyticsSection').classList.toggle('active'));
        document.getElementById('logoutBtn').addEventListener('click', function() {
            if (confirm(translations[currentLang].logoutConfirm)) {
                isAdmin = false;
                document.getElementById('adminPanel').classList.remove('active');
                document.getElementById('viewSuggestionsBtn').style.display = 'none';
                document.getElementById('analyticsBtn').style.display = 'none';
                document.getElementById('analyticsSection').classList.remove('active');
                renderModels();
            }
        });

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            
            if (user === ADMIN_USERNAME && pass === ADMIN_PASSWORD) {
                isAdmin = true;
                document.getElementById('adminPanel').classList.add('active');
                document.getElementById('viewSuggestionsBtn').style.display = 'block';
                document.getElementById('analyticsBtn').style.display = 'block';
                document.getElementById('loginModal').classList.remove('active');
                updateLanguage();
                renderModels();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                alert(translations[currentLang].welcome);
            } else {
                document.getElementById('loginMessage').textContent = translations[currentLang].invalidCredentials;
                document.getElementById('loginMessage').className = 'message error-message';
            }
        });

        document.getElementById('suggestionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const suggestion = {
                id: Date.now(),
                name: document.getElementById('suggestionName').value,
                email: document.getElementById('suggestionEmail').value,
                message: document.getElementById('suggestionText').value,
                date: new Date().toISOString()
            };
            let suggestions = JSON.parse(localStorage.getItem('roblox-suggestions')) || [];
            suggestions.push(suggestion);
            localStorage.setItem('roblox-suggestions', JSON.stringify(suggestions));
            document.getElementById('suggestionMessage').textContent = translations[currentLang].thankYou;
            document.getElementById('suggestionMessage').className = 'message success-message';
            document.getElementById('suggestionForm').reset();
            setTimeout(() => document.getElementById('suggestionModal').classList.remove('active'), 2000);
        });

        document.getElementById('modelImage').addEventListener('change', function(e) {
            const file = e.target.files[0];
            document.getElementById('imageName').textContent = file ? file.name : translations[currentLang].noImage;
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    document.getElementById('imagePreview').src = event.target.result;
                    document.getElementById('imagePreview').style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('modelFile').addEventListener('change', function(e) {
            document.getElementById('fileName').textContent = e.target.files[0] ? e.target.files[0].name : translations[currentLang].noFile;
        });

        document.getElementById('modelForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const t = translations[currentLang];
            const name = document.getElementById('modelName').value.trim();
            const category = document.getElementById('modelCategory').value;
            const description = document.getElementById('modelDescription').value.trim();
            const instructions = document.getElementById('setupInstructions').value.trim();
            const tagsStr = document.getElementById('modelTags').value;
            const tags = tagsStr ? tagsStr.split(',').map(t => t.trim()).filter(t => t) : [];
            const imageInput = document.getElementById('modelImage');
            const fileInput = document.getElementById('modelFile');
            const editingId = document.getElementById('editingId').value;
            
            if (!name || !category || !description || !instructions) {
                document.getElementById('adminMessage').textContent = '‚ö†Ô∏è Please fill all required fields!';
                document.getElementById('adminMessage').className = 'message error-message';
                return;
            }

            if (!editingId && !fileInput.files[0]) {
                document.getElementById('adminMessage').textContent = translations[currentLang].selectModelFile;
                document.getElementById('adminMessage').className = 'message error-message';
                return;
            }

            const finalize = (imageData, fileData, fileName) => {
                if (editingId) {
                    const idx = models.findIndex(m => m.id == editingId);
                    if (idx !== -1) {
                        models[idx] = { 
                            ...models[idx], 
                            name, 
                            category, 
                            description, 
                            instructions, 
                            tags, 
                            imageData: imageData || models[idx].imageData,
                            fileData: fileData || models[idx].fileData,
                            fileName: fileName || models[idx].fileName 
                        };
                        document.getElementById('adminMessage').textContent = t.updated;
                        document.getElementById('adminMessage').className = 'message success-message';
                    }
                } else {
                    models.push({ 
                        id: Date.now(), 
                        name, 
                        category, 
                        description, 
                        instructions, 
                        tags, 
                        imageData, 
                        fileData, 
                        fileName, 
                        downloads: 0,
                        createdAt: new Date().toISOString()
                    });
                    document.getElementById('adminMessage').textContent = t.added;
                    document.getElementById('adminMessage').className = 'message success-message';
                }
                saveData(); 
                renderModels(); 
                updateStats(); 
                resetForm();
            };

            if (imageInput.files[0]) {
                const r1 = new FileReader();
                r1.onload = (ev1) => {
                    const imgData = ev1.target.result;
                    if (fileInput.files[0]) {
                        const r2 = new FileReader();
                        r2.onload = (ev2) => finalize(imgData, ev2.target.result, fileInput.files[0].name);
                        r2.readAsDataURL(fileInput.files[0]);
                    } else finalize(imgData, null, null);
                };
                r1.readAsDataURL(imageInput.files[0]);
            } else if (fileInput.files[0]) {
                const r2 = new FileReader();
                r2.onload = (ev2) => finalize(null, ev2.target.result, fileInput.files[0].name);
                r2.readAsDataURL(fileInput.files[0]);
            } else finalize(null, null, null);
        });

        document.getElementById('searchInput').addEventListener('input', renderModels);
        document.getElementById('categoryFilter').addEventListener('change', renderModels);
        document.getElementById('ratingFilter').addEventListener('change', renderModels);
        document.getElementById('sortBy').addEventListener('change', renderModels);
        document.getElementById('languageSelect').addEventListener('change', (e) => {
            currentLang = e.target.value;
            updateLanguage();
            renderModels();
        });
        
        document.getElementById('newsletterSubscribeBtn').addEventListener('click', subscribeNewsletter);
        document.getElementById('exportCSVBtn').addEventListener('click', exportToCSV);
        document.getElementById('galleryCloseBtn').addEventListener('click', () => document.getElementById('galleryLightbox').classList.remove('active'));
        document.getElementById('bulkDeleteBtn').addEventListener('click', function() {
            if (selectedModels.length === 0) {
                alert('Select models first');
                return;
            }
            if (confirm(`Delete ${selectedModels.length} models?`)) {
                models = models.filter(m => !selectedModels.includes(m.id));
                selectedModels = [];
                saveData();
                renderModels();
                updateStats();
                renderManageModels();
            }
        });

        const savedTheme = localStorage.getItem('roblox-theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            document.getElementById('themeBtn').textContent = '‚òÄÔ∏è Light Mode';
        }
        
        loadData();
        updateLanguage();
        loadModelFromURL();
    </script>
</body>
</html>
